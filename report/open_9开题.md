## 实施方案

​		系统由STM32F103C8T6最小系统、电源模块、超声波测距模块（如HC-SR04）、LCD显示模块、按键输入模块、声光报警模块组成，单片机定时触发超声波测距，计算距离并转换为液位高度，同时进行变化量计算与阈值判断，结果通过LCD显示，异常状态触发蜂鸣器与LED报警。系统结构图如图x所示。

![image-20251225222531574](C:\Users\权恒毅\AppData\Roaming\Typora\typora-user-images\image-20251225222531574.png)

​		系统以STM32F103C8T6最小系统为核心，整体采用多超声波传感器协同工作的结构设计。单片机通过UART接口分别与三个超声波模块通信，其中超声波模块1用于零点位置标定，为液位测量提供稳定可靠的参考基准；由于在100 cm量程范围内实现毫米级测量精度本身具有较高难度，单一超声波传感器难以长期稳定满足±3 mm误差要求，超声波模块2与模块3在安装高度上存在已知高度差，分别对液面进行测距，通过获取不同空间位置的测量结果进行对比与融合，以减小单一传感器在远距离测量时受声速波动、回波衰减及液面扰动带来的误差。单片机对多路测距数据进行统一处理与融合计算，得到更为准确和稳定的液位高度信息，并进一步完成液位变化量计算与阈值判断。测量结果及系统状态通过SPI接口驱动LCD显示模块进行显示，用户可通过按键输入完成参数设置与模式切换，声光报警模块则由IO口直接控制，在液位超限时及时发出报警信号。软件流程图如图x所示。

![image-20251225223530438](C:\Users\权恒毅\AppData\Roaming\Typora\typora-user-images\image-20251225223530438.png)

（1）控制核心：本系统以 STM32F103 单片机作为核心控制单元，该芯片基于 ARM Cortex-M3 内核，最高主频可达 72 MHz，具备较强的运算能力和实时控制性能，能够满足多路超声波数据采集、融合计算以及人机交互控制等任务需求。芯片内部集成了丰富的外设资源，包括多组定时器、USART、SPI、I²C 等通信接口，既可用于超声波模块的数据接收与时序管理，也可驱动 LCD 显示模块完成信息刷新。同时，STM32F103 具有功耗低、成本适中、开发资料丰富等优点，配合成熟的标准外设库，便于系统功能的实现与后期调试，为液位测量系统的稳定运行提供了可靠的硬件基础。

（2）LCD 显示屏模块：LCD 显示屏作为系统的人机交互核心部件，用于实时显示超声波测距结果、计算得到的液位高度、液位变化量、报警阈值以及系统工作状态等信息。显示模块通过 SPI 接口与 STM32F103 单片机相连，具有通信线少、刷新速度快、驱动方式简单等特点，适合嵌入式测量系统应用。在本项目中，LCD 屏幕不仅提升了系统信息显示的直观性与可读性，还为用户进行参数设置与状态监控提供了良好交互界面，使液位测量与报警过程更加直观、易于操作。

（5）超声波测距模块：本系统选用电应普科技 DYP-A22-V1.0 超声波测距模块作为液位检测核心传感器。该模块采用一体化设计，内部集成超声波发射、接收及信号处理电路，支持 UART 等多种通信方式，测量范围可覆盖 1～300 cm，响应速度快，适用于中小型容器的非接触式液位测量。

## 任务内容与指标

**任务内容**

​		本课题要求在研究超声波测距原理和微控制器应用技术的基础上，结合模拟/数字电路、传感器技术、嵌入式编程及人机交互等知识，利用电路设计、单片机开发工具，以一款主流单片机（如STC89C52、STM32F103等）作为核心控制器，选用超声波传感器模块和LCD液晶显示器，设计一套液位监控系统。实现对容器内液位高度的非接触式自动测量，通过计算液面与固定参考点之间的距离变化，得出液位高度，并进行实时显示与监控。设计必须注意作品的实用性和性价比，同时考虑节能、环境、社会、法律等非技术因素。

​		设计以单片机为核心的最小系统电路、超声波传感器驱动与回波检测电路、LCD显示电路、按键输入电路及声光报警电路等；同时，使用C语言等编程工具开发相应的主控程序、超声波发射/接收时序控制程序、距离计算与液位转换算法、显示程序及报警判断程序，完成从硬件设计制作到软件编程调试的全过程。

（1）具备非接触式液位测量功能，系统能通过超声波模块周期性地向液面发射超声波并接收回波，准确测量出传感器到液面的距离。

（2）系统测量范围应覆盖常见中小型容器，设定为 5 cm 至 100 cm。

（3）具备液位变化量计算与显示功能，系统能通过记录初始液位高度，并计算与当前测量的差值，实时显示液位的高度变化量，变化量显示分辨率达到 1 mm。

（4）具备高低液位报警功能，用户可通过按键自行设定液位上限和下限报警阈值。当液位超过设定范围时，系统能立即通过蜂鸣器和LED指示灯发出声光报警信号，报警响应延迟 ≤ 1秒。

（5）使用LCD液晶显示屏清晰、直观地显示信息，包括：实时测量距离值、计算得出的当前液位高度、液位变化量、设定的报警阈值以及系统状态（正常/报警）。

（6）系统应具备良好的稳定性和抗干扰能力。在室温环境下，对静止液面进行连续测量，其读数波动范围不超过 ±3 mm。系统应能有效处理因液面轻微波动或环境中突发噪音导致的偶然误测。

（7）设计液位监控系统的机械外观。

（8）设计液位监控系统的单片机主控电路与超声波测量的外围电路。

**指标**

（1）静态液位的测量误差≤3 mm。

（2）LCD显示当前液位高度变化量的分辨率达到1mm。

（3）当液位高度超出或低于设定阈值时，发出警报信号的响应延迟≤ 1秒。

（4）静止时液位高度读数范围波动≤3mm。

